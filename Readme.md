	This is the hard mode version of the assignment